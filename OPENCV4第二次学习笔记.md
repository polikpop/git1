# OPENCV4





## 1. 认识Mat

### 1.1Mat类的基本概念

 		Mat类是类似于int, double的一种数据类型， 以矩阵的形式存储数据，可以有很多维，不一定是二维。



Mat类的结构如下：

<img src="/home/xushuo/图片/BA18F747E4D77E257DC74FBBD4F35D69.png" alt="BA18F747E4D77E257DC74FBBD4F35D69" style="zoom:50%;" />





Mat类存储的数据有好几种类型，但是因为不同平台对于int，float规定可能有变，所以做出如下对于数据类型的统一规定：

![02D2D39B4D28252B8E22D9F780F72A53](/home/xushuo/图片/02D2D39B4D28252B8E22D9F780F72A53.png)



<img src="/home/xushuo/图片/52EB6A91BE19269ECA4500BF8F28E0AA.png" alt="52EB6A91BE19269ECA4500BF8F28E0AA" style="zoom: 33%;" />

### 1.2 Mat类的创建与赋值



* 利用矩阵宽，高和类型参数创建Mat对象

  ```c++
  cv::Mat::Mat (int rows, int cols, int type)
  ```

  其中，前两个参数代表行数和列数，第三个代表**数据类型**，如：**CV_8UC1**,重要的是，C1代表这是一个单通道矩阵，我们可以在上面一小节中的数据类型后加**C(n)**表示这个对象有几个通道。

* 利用Size结构创建

  ```c++
  cv::Mat::Mat (Size size, int type)
      
  //如：Mat b(Size(3,3), CV_8UC1) ;   
  ```

* 利用已有的Mat对象创建

  ```c++
  //假如我们已经有了一个 a 矩阵
  
  //接着创建c 
  Mat c(a, Range(2,5), Range(2,5));
  
  //注意2-5不包括2，5 且用这种方法创建数据时a中必须含有数据
  ```



* 创建时赋值 ： 直接在type参数后面加Scalar参数，有几个通道就给几个数。

* 利用类方法赋值：用类方法创建特殊矩阵，如对角矩阵

* 用枚举法创建：上面两种都不能对每一个像素点分别赋值，所以我们可以使用枚举法：

  ```c++
  cv::Mat a = (cv::Mat_<int>(3,3)<<1, 2, 3, 4, 5, 6, 7, 8, 9);
  //对一个3*3的矩阵分别赋值，注意尖括号里面填的是double等数据类型，不是CV_8U
  ```

  ---

  

  ### 1.3 Mat 读取

* Mat类在数据中的存储形式如下：



<img src="/home/xushuo/图片/0EF4EA181E244294F17F0BF20884326E.png" alt="0EF4EA181E244294F17F0BF20884326E" style="zoom:50%;" />



* Mat类对象的常用属性（可以用对象直接调用）

<img src="/home/xushuo/图片/D6505EA21DC268A71E13DE3E437D9683.png" alt="D6505EA21DC268A71E13DE3E437D9683" style="zoom:67%;" />



* Mat元素的读取：

  使用**at**方法读取Mat矩阵元素， **at (int row, int col)**

  ```c++
  //单通道
  int value = (int)a.at<unchar>(0,0)
  
      
  //多通道，因为多通道元素的每个元素有多个值，所以不能用int存， 所幸OPENCV已经帮我们定义了一些类型
  cv::Vec3b vc3 = b.at<cv::Vec3b>(0,0);
  //Vec3b代表一个元素有三个通道 每个值是unchar类型
  int first = (int)vc3.val[0];  //读取第一个通道的值
  ```

  也可以使用统一转化的方法，这样就不需要知道对象中元素的类型。

  补充：

  ---

  ### 1.4 Mat的运算

* 四则运算

  

  * 符号运算

    这种方法我们可以直接使用 **+  -  *  /** 进行运算。做运算时两个Mat内的数据类型要一致。

  * 两个矩阵相乘

    可以普通矩阵乘法，满足一般规律。

    可以点积，要求两个矩阵中元素个数相同，维度则不做要求。

    也可以对应位元素进行乘积，矩阵维度必须一样。

  * 也可以利用OPENCV自带函数。

  ---

  

  

  

  ## 2.  图像的加载与保存

  

  ### 2.1  图像读取 

- **imread**

  - 第一个参数为**filename** 写文件名称及其路经
  - 第二个参数为**flags**,为读取图像形式的方法，默认为**彩色读取**

  ###  2.2 图像显示

- **namedWindow**
  - 第一个参数为winname，可以设置窗口的名称。
  - 第二个参数为flags，设置窗口属性。

- **imshow**

  - 第一个参数为winname, 即上面函数的第一个参数
  - 第二个参数为mat，即要显示的图像对象

  ###  2.3  图像保存

- **imwrite**
  - 第一个参数为filename, 为保存图像的地址和格式。
  - 第二个参数为img, 为要保存的图像对象。
  - 第三个参数为params, 对保存图像的属性处理，如要不要压缩。





